"use strict";(self.webpackChunkaidr_bastion_docs=self.webpackChunkaidr_bastion_docs||[]).push([[876],{8437:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=i(4848),l=i(8453);const r={},t="Pipelines",o={id:"pipelines",title:"Pipelines",description:"1. Regex Pipeline (regex)",source:"@site/docs/pipelines.md",sourceDirName:".",slug:"/pipelines",permalink:"/AIDR-Bastion/docs/pipelines",draft:!1,unlisted:!1,editUrl:"https://github.com/artnebo/AIDR-Bastion/tree/main/docs-site/docs/pipelines.md",tags:[],version:"current",frontMatter:{}},c={},d=[{value:"1. Regex Pipeline (<code>regex</code>)",id:"1-regex-pipeline-regex",level:2},{value:"2. Similarity Pipeline (<code>similarity</code>)",id:"2-similarity-pipeline-similarity",level:2},{value:"3. Code Analysis Pipeline (<code>code_analysis</code>)",id:"3-code-analysis-pipeline-code_analysis",level:2},{value:"4. ML Pipeline (<code>ml</code>)",id:"4-ml-pipeline-ml",level:2},{value:"5. LLM Pipeline (<code>openai</code>)",id:"5-llm-pipeline-openai",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"pipelines",children:"Pipelines"}),"\n",(0,s.jsxs)(n.h2,{id:"1-regex-pipeline-regex",children:["1. Regex Pipeline (",(0,s.jsx)(n.code,{children:"regex"}),")"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Pattern-based detection using regular expressions"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rules"}),": YAML files in ",(0,s.jsx)(n.code,{children:"app/pipelines/regex_pipeline/rules/"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Categories"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Injection"}),": SQL, command execution, path traversal"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Obfuscation"}),": Character obfuscation, encoding, Unicode homoglyphs"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Override"}),": Role play, filter disabling, context splicing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Leakage"}),": Direct prompt requests, forced repetition"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PII"}),": Email, phone, credit cards, passwords, API keys, UUIDs, IBAN"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Semantic"}),": Emotional manipulation, authority fallacy, multilingual attacks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DoS"}),": Character/word repetition, regex DoS"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Best for"}),": Known attack patterns and simple text analysis"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"2-similarity-pipeline-similarity",children:["2. Similarity Pipeline (",(0,s.jsx)(n.code,{children:"similarity"}),")"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Vector-based similarity detection against known harmful prompts"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend"}),": OpenSearch with vector search"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Required"}),": OpenSearch configuration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configuration"}),": ",(0,s.jsx)(n.code,{children:"SIMILARITY_NOTIFY_THRESHOLD"}),", ",(0,s.jsx)(n.code,{children:"SIMILARITY_BLOCK_THRESHOLD"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Best for"}),": Detecting variations of known attacks"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"3-code-analysis-pipeline-code_analysis",children:["3. Code Analysis Pipeline (",(0,s.jsx)(n.code,{children:"code_analysis"}),")"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Static code analysis using Semgrep"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Languages"}),": Python, JavaScript, Java, C++, and more"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rules"}),": Security-focused patterns"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Best for"}),": Code injection and vulnerability detection"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"4-ml-pipeline-ml",children:["4. ML Pipeline (",(0,s.jsx)(n.code,{children:"ml"}),")"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": Machine learning-based classification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configuration"}),": Requires ",(0,s.jsx)(n.code,{children:"ML_PIPELINE_PATH"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Model"}),": Custom-trained model for prompt classification"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Best for"}),": General malicious content detection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Required"}),": Configured environment ",(0,s.jsx)(n.code,{children:"EMBEDDINGS_MODEL"})]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"5-llm-pipeline-openai",children:["5. LLM Pipeline (",(0,s.jsx)(n.code,{children:"openai"}),")"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),": AI-powered analysis using OpenAI GPT models"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configuration"}),": Requires ",(0,s.jsx)(n.code,{children:"OPENAI_API_KEY"})," and ",(0,s.jsx)(n.code,{children:"OPENAI_MODEL"})," (default is gpt-4). The ",(0,s.jsx)(n.code,{children:"OPENAI_BASE_URL"})," environment variable is optional; by default, it is set to ",(0,s.jsx)(n.a,{href:"https://api.openai.com/v1",children:"https://api.openai.com/v1"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Features"}),": JSON response format, configurable models, intelligent decision-making"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Response Format"}),": Returns structured JSON with status (block/notify/allow) and reasoning"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Best for"}),": Complex reasoning and context-aware analysis"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>o});var s=i(6540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);